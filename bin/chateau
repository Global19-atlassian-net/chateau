#!/usr/bin/env node

var argv = require('optimist').argv,
    path = require('path'),
    fs = require('fs')
    configFile = {};

if (argv.h || argv.help) {
    console.log([
    "usage: chateau [options]",
    "",
    "options:",
    "  -f [config_file]   Default file: config.js",
    "  -p [server_port]   Default port: 3000",
    "  -h                 Shows this help",
    ].join('\n'));
    process.exit();
}

configFile = path.resolve(argv.f || 'config.js');

if(!fs.existsSync(configFile))
{
    console.warn('Warning:','Configuration file does not exists. Using default one instead.');
    configFile = path.resolve(__dirname, '../', 'config.template.js');
}

configFile = require(configFile);

if(argv.p) {
  configFile.expressPort = argv.p;
}

require('../app.js')(configFile);
